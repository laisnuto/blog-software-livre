---
title: "Contribuição final: contribuindo com o KW e o Nushell"
description: "Relato de como foi minha a contribuição que fizemos para o kw e nushell"
image: "../../public/blogs/nushell+kw.png"
publishedAt: "2024-06-22"
updatedAt: "2024-06-22"
author: "laisnuto"
isPublished: true
tags: 

- kw
- nushell
- contribuição
---

Durante o semestre, eu e minha dupla tivemos a oportunidade de trabalhar em contribuições para dois projetos open source: KW e Nushell.
Então como formar de juntar o conhecimento adquirido com esses dois projetos, decidimos fazer como contribuição final a junção entre eles.
Ou seja, fizemos completions no nushell em relação aos comandos do kw, e no kw colocamos o script de instalação do nushell

## Contribuindo com Nushell

Para contribuir com o Nushell, criamos scripts de autocompletar para o KW. Com o auxilio do comando --help que listava os possíveis comandos e subcomandos do kw, eu e minha dupla nos dividimos para cada um pegar metade dos comandos principais abaixo e escrever todos os subcomandos

```bash
def "nu-complete kw subcommands" [] {
    [
        [value description];
        ["init" "Initialize kworkflow config file"]
        ["build" "Build kernel"]
        ["deploy" "Deploy a new kernel image to a target machine"]
        ["bd" "Build and install kernel image/modules"]
        ["diff" "Diff files"]
        ["ssh" "SSH support"]
        ["codestyle" "Apply checkpatch on directory or file"]
        ["self-update" "kw self-update mechanism"]
        ["maintainers" "Get maintainers and mailing list"]
        ["kernel-config-manager" "Manage kernel .config files"]
        ["config" "Set kw config options"]
        ["remote" "Manage machines available via ssh"]
        ["explore" "Explore string patterns"]
        ["pomodoro" "kw pomodoro support"]
        ["report" "Show kw pomodoro reports and kw usage statistics"]
        ["device" "Show basic hardware information"]
        ["backup" "Save or restore kw data"]
        ["debug" "Linux kernel debug utilities"]
        ["mail" "Send patches via email"]
        ["env" "Handle kw envs"]
        ["patch-hub" "Interface to lore kernel"]
        ["clear-cache" "Clear files generated by kw"]
        ["drm" "Set of commands to work with DRM drivers"]
        ["vm" "Basic support for QEMU image"]
        ["version" "Show kw version"]
        ["man" "Show manual pages"]
        ["h" "Displays this help message"]
        ["help" "Show kw man page"]
    ]
}
```
Depois de algumas horas, conseguimos concluir as completions, nos juntamos para conferir tudo junto e fizemos o pull request e rapidamente ele foi aceito.

Tão rápido que percebemos que tinhamos esquecido de usar a samart completion com o "--alert" e antes de conseguirmos subir a correção na mesma branch que fizemos o pull request, eles já tinham aceito e mergeado. Mas então, criei uma nova branch para corrigir que logo foi aceita também.


## Contribuindo com KW
A instalação do KW é feita via um script setup.sh. A ideia inicial foi colocar cópia do nosso script de autocompletar dentro do repositório do kw, porém depois vimos que seria melhor baixá-lo durante a instalação, pois assim o script não precisaria ficar sendo atualizado em dois repositórios diferentes. 
O fluxo que criado verifica se o usuário possui o Nushell instalado, pergunta se ele deseja instalar as completions e, se sim, baixa o script e instrui o usuário sobre como ativá-lo, se não, informa o link do repositório para fazer o processo manualmente.
Depois de enviar o pull request, foram solicitadas algumas mudanças que foram corrigidas mas uma das solicitações era mais uma sugestão do que correção, então optamos por ver se seria aceito sem precisar mudar além do que tinha sido corrigido e estamos esperando a resposta do pessoal do kw. 

## Conclusão
Contribuir para o KW e o Nushell foi um "crossover" muito interessante, pois combinou nossos conhecimentos adquiridos ao longo do semestre. Além disso, essa contribuição deixou clara a importância de uma boa documentação, já que facilitou bastante o trabalho de fazer ansiosa completions corretas e eficientes.